# Generated by Django 2.2.1 on 2019-09-09 14:05

from django.db import migrations, models


def move_files_in_book(apps, schema_editor):
    for book in apps.get_model('library', 'Book').objects.all():
        if book.bookfile_set.count():
            book_file = book.bookfile_set.first()
            book.url = book_file.url
            book.size = book_file.size
            book.format = book_file.format
            book.save()


class Migration(migrations.Migration):

    dependencies = [
        ('library', '0017_auto_20190315_1822'),
    ]

    operations = [
        migrations.AddField(
            model_name='book',
            name='format',
            field=models.PositiveSmallIntegerField(choices=[(0, 'PDF'), (1, 'DJVU')], default=0, verbose_name='Формат файла'),
        ),
        migrations.AddField(
            model_name='book',
            name='size',
            field=models.FloatField(default=0, help_text='Условный размер файла в мегабайтах', verbose_name='Размер файла'),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='book',
            name='url',
            field=models.URLField(default='http://example.com', verbose_name='Ссылка для скачивания'),
            preserve_default=False,
        ),
        migrations.RunPython(move_files_in_book),
    ]
